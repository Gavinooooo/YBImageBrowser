# YBImageBrowser 10åˆ†æ€§èƒ½ä¼˜åŒ–ä½¿ç”¨æŒ‡å—

## ğŸš€ ä¸€é”®ä¼˜åŒ– (æ¨è)

æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼ï¼Œé€‚ç”¨äºå¤§éƒ¨åˆ†åœºæ™¯ï¼š

```objective-c
#import "YBImageBrowserPerformance.h"

// åˆ›å»ºæµè§ˆå™¨
YBImageBrowser *browser = [YBImageBrowser new];
browser.dataSourceArray = imageDataArray;

// ä¸€é”®æ€§èƒ½ä¼˜åŒ– - æ ¹æ®è®¾å¤‡è‡ªåŠ¨é…ç½®æœ€ä½³å‚æ•°
[YBIBPerformanceConfigurator optimizeBrowser:browser 
                                  imageCount:imageDataArray.count 
                             useAdvancedFeatures:YES];

[browser show];
```

## ğŸ“± åœºæ™¯åŒ–é…ç½®

### 1. ç›¸å†Œæµè§ˆæ¨¡å¼
```objective-c
// é€‚ç”¨äºæœ¬åœ°ç›¸å†Œå›¾ç‰‡æµè§ˆ
[YBIBPerformanceConfigurator configureForPhotoAlbum:browser];
```

### 2. ç½‘ç»œå›¾ç‰‡æµè§ˆæ¨¡å¼  
```objective-c
// é€‚ç”¨äºç½‘ç»œå›¾ç‰‡ï¼Œå¯ç”¨æ¸è¿›å¼åŠ è½½
[YBIBPerformanceConfigurator configureForNetworkImages:browser];
```

### 3. å¤§å›¾æµè§ˆä¼˜åŒ–
```objective-c
// é’ˆå¯¹å¤§å›¾ç‰‡ä¼˜åŒ– (averageSize: å¹³å‡å›¾ç‰‡å¤§å°MB)
[YBIBPerformanceConfigurator optimizeForLargeImages:browser 
                                  averageImageSizeMB:8.0];
```

### 4. å¤šå›¾æµè§ˆä¼˜åŒ–
```objective-c
// é’ˆå¯¹å¤§é‡å›¾ç‰‡ä¼˜åŒ–
[YBIBPerformanceConfigurator optimizeForManyImages:browser 
                                         imageCount:500];
```

### 5. ä½æ€§èƒ½è®¾å¤‡ä¼˜åŒ–
```objective-c
// é’ˆå¯¹ä½é…è®¾å¤‡ä¼˜åŒ–
[YBIBPerformanceConfigurator optimizeForLowEndDevice:browser];
```

## ğŸ¯ è§£å†³æ‚¨çš„å…·ä½“é—®é¢˜

### é—®é¢˜1: ç‚¹å‡»å›¾ç‰‡åˆ°æ”¾å¤§æ‰“å¼€æ…¢

```objective-c
// æ–¹æ¡ˆ1: å¯ç”¨æ™ºèƒ½é¢„åŠ è½½
YBIBSmartPreloader *preloader = [[YBIBSmartPreloader alloc] initWithBrowser:browser];
[preloader startSmartPreloading];

// æ–¹æ¡ˆ2: å…³é—­å¼‚æ­¥è§£ç ï¼Œå‡å°‘ç­‰å¾…æ—¶é—´
for (YBIBImageData *data in imageDataArray) {
    data.shouldPreDecodeAsync = NO;  // åŒæ­¥è§£ç 
    data.cuttingZoomScale = 3.0;     // åˆç†çš„è£å‰ªé˜ˆå€¼
}

// æ–¹æ¡ˆ3: å¯ç”¨æ¸è¿›å¼åŠ è½½
for (YBIBImageData *data in imageDataArray) {
    YBIBProgressiveLoader *loader = [[YBIBProgressiveLoader alloc] initWithImageData:data];
    [loader startProgressiveLoadingWithProgress:^(CGFloat progress) {
        // æ˜¾ç¤ºåŠ è½½è¿›åº¦
    } completion:^(UIImage *finalImage, NSError *error) {
        // åŠ è½½å®Œæˆ
    }];
}
```

### é—®é¢˜2: å·¦å³åˆ‡æ¢å¡é¡¿

```objective-c
// æ–¹æ¡ˆ1: å¢åŠ é¢„åŠ è½½å’Œç¼“å­˜
browser.preloadCount = 5;  // å¢åŠ é¢„åŠ è½½æ•°é‡
browser.ybib_imageCache.imageCacheCountLimit = 20;  // å¢åŠ ç¼“å­˜

// æ–¹æ¡ˆ2: å¯ç”¨é«˜çº§ç¼“å­˜ç³»ç»Ÿ
YBIBAdvancedImageCache *cache = [YBIBAdvancedImageCache sharedCache];
cache.maxMemoryCacheSizeMB = 200;  // å¢åŠ å†…å­˜ç¼“å­˜
cache.maxDiskCacheSizeMB = 1000;   // å¢åŠ ç£ç›˜ç¼“å­˜

// æ–¹æ¡ˆ3: å¯ç”¨å†…å­˜è‡ªé€‚åº”ç®¡ç†
YBIBMemoryAdaptiveManager *memoryManager = [YBIBMemoryAdaptiveManager sharedManager];
[memoryManager registerBrowser:browser];
[memoryManager startMemoryMonitoring];
```

## ğŸ’¾ é«˜çº§å†…å­˜ç®¡ç†

### è‡ªåŠ¨å†…å­˜ä¼˜åŒ–
```objective-c
// å¯ç”¨å®Œæ•´çš„æ€§èƒ½ç›‘æ§å’Œè‡ªåŠ¨ä¼˜åŒ–
[YBIBPerformanceConfigurator enableFullPerformanceMode:browser];

// å†…å­˜å‹åŠ›å›è°ƒ
[[YBIBMemoryAdaptiveManager sharedManager] setMemoryPressureHandler:^(YBIBMemoryPressureLevel level) {
    switch (level) {
        case YBIBMemoryPressureLevelWarning:
            NSLog(@"å†…å­˜è­¦å‘Šï¼Œç³»ç»Ÿå·²è‡ªåŠ¨ä¼˜åŒ–");
            break;
        case YBIBMemoryPressureLevelCritical:
            NSLog(@"å†…å­˜ä¸¥é‡ä¸è¶³ï¼Œå¯åŠ¨ç´§æ€¥ä¼˜åŒ–");
            break;
        case YBIBMemoryPressureLevelUrgent:
            NSLog(@"å†…å­˜ç´§æ€¥çŠ¶æ€ï¼Œå·²æœ€å°åŒ–é…ç½®");
            break;
    }
}];
```

### æ‰‹åŠ¨å†…å­˜æ§åˆ¶
```objective-c
// ä½å†…å­˜è®¾å¤‡é…ç½®
if ([UIDevice currentDevice].physicalMemory < 3 * 1024 * 1024 * 1024) { // < 3GB
    browser.preloadCount = 2;
    browser.ybib_imageCache.imageCacheCountLimit = 6;
    
    // å›¾ç‰‡æ•°æ®ä¼˜åŒ–
    for (YBIBImageData *data in imageDataArray) {
        data.shouldPreDecodeAsync = NO;
        data.cuttingZoomScale = 2.0;
        data.maxZoomScale = 2.0;
    }
}
```

## ğŸ“Š æ€§èƒ½ç›‘æ§

### å¯ç”¨æ€§èƒ½ç›‘æ§
```objective-c
YBIBPerformanceMonitor *monitor = [YBIBPerformanceMonitor sharedMonitor];
[monitor addBrowserToMonitor:browser];
[monitor startMonitoring];

// ç›‘æ§å›è°ƒ
dispatch_after(dispatch_time(DISPATCH_TIME_NOW, 10 * NSEC_PER_SEC), dispatch_get_main_queue(), ^{
    NSDictionary *report = [monitor generatePerformanceReport];
    NSLog(@"æ€§èƒ½æŠ¥å‘Š: %@", report);
    
    // è·å–ä¼˜åŒ–å»ºè®®
    NSArray *suggestions = [monitor performanceOptimizationSuggestions];
    NSLog(@"ä¼˜åŒ–å»ºè®®: %@", suggestions);
});
```

### å¯¼å‡ºæ€§èƒ½æ•°æ®
```objective-c
// å¯¼å‡ºJSONæ ¼å¼æ•°æ®
NSString *jsonData = [monitor exportPerformanceDataAsJSON];

// å¯¼å‡ºCSVæ ¼å¼æ•°æ®  
NSString *csvData = [monitor exportPerformanceDataAsCSV];
```

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### è‡ªå®šä¹‰é…ç½®å­—å…¸
```objective-c
NSDictionary *customConfig = @{
    @"preloadCount": @(4),
    @"cacheCount": @(15),
    @"enableAdvancedFeatures": @(YES),
    @"enablePerformanceMonitoring": @(YES)
};

[YBIBPerformanceConfigurator applyCustomConfiguration:browser config:customConfig];
```

### æ‰¹é‡ä¼˜åŒ–å›¾ç‰‡æ•°æ®
```objective-c
// æ ¹æ®åœºæ™¯æ‰¹é‡ä¼˜åŒ–
[YBIBPerformanceConfigurator optimizeImageDatas:imageDataArray 
                                     forScenario:@"network"];

// æ™ºèƒ½é…ç½®å•ä¸ªå›¾ç‰‡æ•°æ®
for (YBIBImageData *data in imageDataArray) {
    [YBIBPerformanceConfigurator smartConfigureImageData:data 
                                                  withURL:data.imageURL];
}
```

## âœ… é…ç½®éªŒè¯

### éªŒè¯å½“å‰é…ç½®
```objective-c
NSDictionary *validation = [YBIBPerformanceConfigurator validateConfiguration:browser];
NSLog(@"é…ç½®éªŒè¯ç»“æœ: %@", validation);

if (![validation[@"valid"] boolValue]) {
    NSArray *warnings = validation[@"warnings"];
    NSArray *suggestions = validation[@"suggestions"];
    NSLog(@"è­¦å‘Š: %@", warnings);
    NSLog(@"å»ºè®®: %@", suggestions);
}
```

### è·å–é…ç½®æ‘˜è¦
```objective-c
NSDictionary *summary = [YBIBPerformanceConfigurator getConfigurationSummary:browser];
NSLog(@"å½“å‰é…ç½®æ‘˜è¦: %@", summary);
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–æ•ˆæœç›‘æ§

```objective-c
// è®°å½•å›¾ç‰‡åŠ è½½æ€§èƒ½
YBIBPerformanceMonitor *monitor = [YBIBPerformanceMonitor sharedMonitor];

// åœ¨å›¾ç‰‡åŠ è½½å¼€å§‹æ—¶è®°å½•
[monitor recordImageLoadStart:imageURL.absoluteString];

// åœ¨å›¾ç‰‡åŠ è½½å®Œæˆæ—¶è®°å½•
[monitor recordImageLoadComplete:imageURL.absoluteString 
                        loadTime:loadTime 
                         success:YES];

// è®°å½•é¡µé¢åˆ‡æ¢æ€§èƒ½
[monitor recordPageSwitch:fromPage 
                   toPage:toPage 
               switchTime:switchTime];
```

## ğŸ¨ å®Œæ•´ä½¿ç”¨ç¤ºä¾‹

```objective-c
#import "YBImageBrowserPerformance.h"

@implementation ViewController

- (void)showOptimizedImageBrowser {
    // 1. åˆ›å»ºå›¾ç‰‡æ•°æ®
    NSMutableArray *imageDataArray = [NSMutableArray array];
    for (NSString *imageURL in self.imageURLs) {
        YBIBImageData *data = [YBIBImageData new];
        data.imageURL = [NSURL URLWithString:imageURL];
        data.projectiveView = self.thumbnailViews[i]; // è½¬åœºåŠ¨ç”»èµ·å§‹è§†å›¾
        [imageDataArray addObject:data];
    }
    
    // 2. åˆ›å»ºæµè§ˆå™¨
    YBImageBrowser *browser = [YBImageBrowser new];
    browser.dataSourceArray = imageDataArray;
    browser.currentPage = self.selectedIndex;
    
    // 3. ä¸€é”®æ€§èƒ½ä¼˜åŒ– (æ¨è)
    [YBIBPerformanceConfigurator optimizeBrowser:browser 
                                      imageCount:imageDataArray.count 
                                 useAdvancedFeatures:YES];
    
    // 4. é’ˆå¯¹æ‚¨çš„å…·ä½“é—®é¢˜è¿›è¡Œé¢å¤–ä¼˜åŒ–
    // è§£å†³æ‰“å¼€æ…¢çš„é—®é¢˜
    for (YBIBImageData *data in imageDataArray) {
        data.shouldPreDecodeAsync = NO;  // å…³é”®ä¼˜åŒ–
    }
    
    // è§£å†³åˆ‡æ¢å¡é¡¿é—®é¢˜
    browser.preloadCount = 5;  // å¢åŠ é¢„åŠ è½½
    browser.ybib_imageCache.imageCacheCountLimit = 20;  // å¢åŠ ç¼“å­˜
    
    // 5. æ˜¾ç¤ºæµè§ˆå™¨
    [browser show];
}

@end
```

## ğŸ’¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®æ€»ç»“

1. **ç«‹å³ç”Ÿæ•ˆçš„ä¼˜åŒ–**ï¼š
   - è®¾ç½® `shouldPreDecodeAsync = NO` è§£å†³æ‰“å¼€æ…¢
   - å¢åŠ  `preloadCount` å’Œç¼“å­˜æ•°é‡è§£å†³åˆ‡æ¢å¡é¡¿

2. **ä¸­æœŸä¼˜åŒ–**ï¼š
   - å¯ç”¨å†…å­˜è‡ªé€‚åº”ç®¡ç†
   - ä½¿ç”¨åœºæ™¯åŒ–é…ç½®

3. **é«˜çº§ä¼˜åŒ–**ï¼š
   - å¯ç”¨å®Œæ•´æ€§èƒ½ç›‘æ§
   - ä½¿ç”¨æ¸è¿›å¼åŠ è½½
   - è‡ªå®šä¹‰ä¼˜åŒ–ç­–ç•¥

4. **æœ€ä½³å®è·µ**ï¼š
   - ä¼˜å…ˆä½¿ç”¨ä¸€é”®ä¼˜åŒ–
   - æ ¹æ®å®é™…åœºæ™¯é€‰æ‹©é…ç½®
   - å®šæœŸæ£€æŸ¥æ€§èƒ½æŠ¥å‘Š
   - é’ˆå¯¹ä½é…è®¾å¤‡ç‰¹æ®Šä¼˜åŒ–

é€šè¿‡è¿™å¥—å®Œæ•´çš„æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆï¼Œæ‚¨çš„YBImageBrowserå°†è·å¾—æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼